# vim:set sw=4 ts=8 et fileencoding=utf8:
# SPDX-License-Identifier: BSD-2-Clause
# SPDX-FileCopyrightText: 2025 Сергей Леонтьев (leo@sai.msu.ru)

message("examples: " ${ERROR_DEFINITIONS})
if (MSVC)
    add_definitions(-W4 -D_CRT_SECURE_NO_WARNINGS)
    if (MSVC_VERSION GREATER_EQUAL 1914)
        add_definitions("/Zc:__cplusplus")  # https://gitlab.kitware.com/cmake/cmake/-/issues/18837
    endif()
else()
    add_definitions(-Wall -Wextra)
endif()

foreach(sfx IN ITEMS "" "_cxx")
    if(sfx STREQUAL "")
        set(novla "_novla")
    else()
        set(novla "")
    endif()
    foreach(vla IN ITEMS "" ${novla})
        foreach(pfx IN ITEMS short long)
            set(base ${pfx}_example${sfx})
            set(tgt ${base}${vla})
            if(sfx STREQUAL "")
                add_executable(${tgt} ${base}.c)
            else()
                add_executable(${tgt} ${base}.cpp)
            endif()
            if(NOT vla STREQUAL "")
                target_compile_options(${tgt} PRIVATE "-DDISABLE_VLA_EXAMPLE")
            endif()
            target_link_libraries(${tgt} PRIVATE CounofNS::CounofNS)
        endforeach()
    endforeach()
endforeach()
